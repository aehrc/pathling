"use strict";(globalThis.webpackChunkpathling_site=globalThis.webpackChunkpathling_site||[]).push([[3822],{5464:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"server/authorization","title":"Authorization","description":"Pathling can perform the role of a resource server within the OpenID Connect framework.","source":"@site/docs/server/authorization.md","sourceDirName":"server","slug":"/server/authorization","permalink":"/docs/server/authorization","draft":false,"unlisted":false,"editUrl":"https://github.com/aehrc/pathling/tree/main/site/docs/server/authorization.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"description":"Pathling can perform the role of a resource server within the OpenID Connect framework."},"sidebar":"server","previous":{"title":"Export view","permalink":"/docs/server/operations/view-export"},"next":{"title":"Admin UI","permalink":"/docs/server/admin-ui"}}');var r=i(4848),s=i(8453);const o={sidebar_position:4,description:"Pathling can perform the role of a resource server within the OpenID Connect framework."},c="Authorization",d={},h=[{value:"Authorities",id:"authorities",level:2},{value:"SMART configuration",id:"smart-configuration",level:2}];function a(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"authorization",children:"Authorization"})}),"\n",(0,r.jsxs)(t.p,{children:["Pathling can perform the role of a resource server within the\n",(0,r.jsx)(t.a,{href:"https://openid.net/connect/",children:"OpenID Connect framework"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["When authorization is enabled through configuration, Pathling will refuse any\nrequests which are not accompanied by a valid\n",(0,r.jsx)(t.a,{href:"https://tools.ietf.org/html/rfc6750",children:"bearer token"}),". The following requirements\nmust be met:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Token is a ",(0,r.jsx)(t.a,{href:"https://tools.ietf.org/html/rfc7519",children:"JSON Web Token"})]}),"\n",(0,r.jsxs)(t.li,{children:["Token contains an\n",(0,r.jsx)(t.a,{href:"https://tools.ietf.org/html/rfc7519#section-4.1.3",children:"audience claim"})," that\nmatches the configured value"]}),"\n",(0,r.jsxs)(t.li,{children:["Token contains\nan ",(0,r.jsx)(t.a,{href:"https://tools.ietf.org/html/rfc7519#section-4.1.1",children:"issuer claim"}),"\nthat matches the configured value"]}),"\n",(0,r.jsxs)(t.li,{children:["Issuer provides\nan ",(0,r.jsx)(t.a,{href:"https://openid.net/specs/openid-connect-discovery-1_0.html",children:"OpenID Connect Discovery endpoint"}),"\nthat provides information about how to validate the token, including a link to\na\n",(0,r.jsx)(t.a,{href:"https://tools.ietf.org/html/rfc7517",children:"JSON Web Key Set"})," containing the signing\nkey. This endpoint needs to be accessible to the Pathling server."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"authorities",children:"Authorities"}),"\n",(0,r.jsxs)(t.p,{children:["Pathling supports a set of authorities that control access to resources and\noperations. Authorities must be provided within the ",(0,r.jsx)(t.code,{children:"authorities"})," claim within\nthe JWT bearer token provided with each request."]}),"\n",(0,r.jsx)(t.mermaid,{value:"%%{init: {'themeVariables': {'fontSize': '14px'}, 'flowchart': {'nodeSpacing': 30, 'rankSpacing': 40}}}%%\ngraph TB\n    operation[\"pathling:[operation]\"]\n    pathling[pathling]\n\n    subgraph Resources[\" \"]\n        direction LR\n        read-resource[\"pathling:read:[resource type]\"]\n        read[pathling:read]\n        write[pathling:write]\n        write-resource[\"pathling:write:[resource type]\"]\n    end\n\n    pathling --\x3e operation\n    pathling --\x3e read\n    pathling --\x3e write\n    read --\x3e read-resource\n    write --\x3e write-resource"}),"\n",(0,r.jsx)(t.p,{children:"\u2192 includes"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Authority"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling"})}),(0,r.jsx)(t.td,{children:"Provides access to all operations and resources, implies all other authorities."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:read"})}),(0,r.jsx)(t.td,{children:"Provides read access to all resource types."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:read:[resource type]"})}),(0,r.jsx)(t.td,{children:"Provides read access to only a specified resource type."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:write"})}),(0,r.jsx)(t.td,{children:"Provides write access to all resource types."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:write:[resource type]"})}),(0,r.jsx)(t.td,{children:"Provides write access to only a specified resource type."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:import"})}),(0,r.jsx)(t.td,{children:"Provides access to the import operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:import-pnp"})}),(0,r.jsx)(t.td,{children:"Provides access to the ping and pull import operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:search"})}),(0,r.jsx)(t.td,{children:"Provides access to the search operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:update"})}),(0,r.jsx)(t.td,{children:"Provides access to the update operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:delete"})}),(0,r.jsx)(t.td,{children:"Provides access to the delete operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:batch"})}),(0,r.jsx)(t.td,{children:"Provides access to the batch operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:bulk-submit"})}),(0,r.jsx)(t.td,{children:"Provides access to the bulk submit operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:export"})}),(0,r.jsx)(t.td,{children:"Provides access to the export operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:view-run"})}),(0,r.jsx)(t.td,{children:"Provides access to the $viewdefinition-run operation."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pathling:view-export"})}),(0,r.jsx)(t.td,{children:"Provides access to the $viewdefinition-export operation."})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["In order to enable access to an operation, an operation authority (e.g.\n",(0,r.jsx)(t.code,{children:"pathling:search"}),") must be provided along with a ",(0,r.jsx)(t.code,{children:"read"})," or ",(0,r.jsx)(t.code,{children:"write"})," authority\n(e.g. ",(0,r.jsx)(t.code,{children:"pathling:read:Patient"}),")."]}),"\n",(0,r.jsx)(t.p,{children:"Where expressions within a request reference multiple different resource types\n(e.g. through resource references), authority for read access to all those\nresources must be present within the token."}),"\n",(0,r.jsxs)(t.p,{children:["The import, delete, batch, and bulk submit operations require ",(0,r.jsx)(t.code,{children:"write"})," authority\nfor all resource types that are referenced within the request."]}),"\n",(0,r.jsxs)(t.p,{children:["The view operations (",(0,r.jsx)(t.code,{children:"view-run"})," and ",(0,r.jsx)(t.code,{children:"view-export"}),") require ",(0,r.jsx)(t.code,{children:"read"})," authority for\nthe resource type specified in the ViewDefinition's ",(0,r.jsx)(t.code,{children:"resource"})," element. For\nexample, a ViewDefinition targeting ",(0,r.jsx)(t.code,{children:"Patient"})," resources requires\n",(0,r.jsx)(t.code,{children:"pathling:read:Patient"})," authority in addition to the operation authority."]}),"\n",(0,r.jsx)(t.h2,{id:"smart-configuration",children:"SMART configuration"}),"\n",(0,r.jsxs)(t.p,{children:["When authorisation is enabled, Pathling exposes a\n",(0,r.jsx)(t.a,{href:"https://hl7.org/fhir/smart-app-launch/conformance.html",children:"SMART configuration document"}),"\nat ",(0,r.jsx)(t.code,{children:"/.well-known/smart-configuration"}),". This document advertises the OAuth\nendpoints and capabilities supported by the server."]}),"\n",(0,r.jsxs)(t.p,{children:["Pathling automatically fetches and merges the issuer's OIDC discovery document\nfrom ",(0,r.jsx)(t.code,{children:"{issuer}/.well-known/openid-configuration"}),". Fields from the OIDC discovery\ndocument are included in the SMART configuration response, with SMART-specific\nfields taking precedence. This provides clients with comprehensive metadata\nabout supported scopes, response types, and other OAuth capabilities without\nrequiring explicit configuration."]}),"\n",(0,r.jsx)(t.p,{children:"The following fields can be configured explicitly and will override any values\nfrom the OIDC discovery document:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"authorization_endpoint"})," (via ",(0,r.jsx)(t.code,{children:"pathling.auth.authUrl"}),")"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"token_endpoint"})," (via ",(0,r.jsx)(t.code,{children:"pathling.auth.tokenUrl"}),")"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"revocation_endpoint"})," (via ",(0,r.jsx)(t.code,{children:"pathling.auth.revokeUrl"}),")"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"capabilities"})," (via ",(0,r.jsx)(t.code,{children:"pathling.auth.capabilities"}),")"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"grant_types_supported"})," (via ",(0,r.jsx)(t.code,{children:"pathling.auth.grantTypesSupported"}),")"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"code_challenge_methods_supported"})," (via\n",(0,r.jsx)(t.code,{children:"pathling.auth.codeChallengeMethodsSupported"}),")"]}),"\n"]})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>c});var n=i(6540);const r={},s=n.createContext(r);function o(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);