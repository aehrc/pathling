"use strict";(globalThis.webpackChunkpathling_site=globalThis.webpackChunkpathling_site||[]).push([[2112],{8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>d});var r=i(6540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},8754:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"server/admin-ui","title":"Admin UI","description":"The admin UI provides a web interface for managing Pathling Server.","source":"@site/docs/server/admin-ui.md","sourceDirName":"server","slug":"/server/admin-ui","permalink":"/docs/server/admin-ui","draft":false,"unlisted":false,"editUrl":"https://github.com/aehrc/pathling/tree/main/site/docs/server/admin-ui.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"description":"The admin UI provides a web interface for managing Pathling Server."},"sidebar":"server","previous":{"title":"Authorization","permalink":"/docs/server/authorization"},"next":{"title":"Caching","permalink":"/docs/server/caching"}}');var t=i(4848),s=i(8453);const l={sidebar_position:7,description:"The admin UI provides a web interface for managing Pathling Server."},d="Admin UI",c={},a=[{value:"Features",id:"features",level:2},{value:"Accessing the UI",id:"accessing-the-ui",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Client ID configuration",id:"client-id-configuration",level:3},{value:"Token authorities",id:"token-authorities",level:3},{value:"Setting up an OAuth client",id:"setting-up-an-oauth-client",level:2},{value:"Required settings",id:"required-settings",level:3},{value:"Auth0",id:"auth0",level:3},{value:"Keycloak",id:"keycloak",level:3},{value:"Standalone deployment",id:"standalone-deployment",level:2},{value:"Building the UI",id:"building-the-ui",level:3},{value:"Environment variables",id:"environment-variables",level:3},{value:"Docker deployment",id:"docker-deployment",level:3},{value:"Static hosting",id:"static-hosting",level:3},{value:"CORS configuration",id:"cors-configuration",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"admin-ui",children:"Admin UI"})}),"\n",(0,t.jsx)(n.p,{children:"Pathling Server includes an admin UI that provides a web interface for common\nserver operations."}),"\n",(0,t.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,t.jsx)(n.p,{children:"The admin UI provides access to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Import"})," - Load FHIR data from NDJSON files or URLs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Export"})," - Bulk export data at system, patient, or group level"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Resources"})," - Browse and search resources using FHIRPath expressions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"View definitions"})," - Manage and execute SQL on FHIR view definitions"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"accessing-the-ui",children:"Accessing the UI"}),"\n",(0,t.jsxs)(n.p,{children:["When running the Pathling Server, the admin UI is available at ",(0,t.jsx)(n.code,{children:"/admin/"}),". For\nexample, if your server is running at ",(0,t.jsx)(n.code,{children:"https://pathling.example.com"}),", the admin\nUI would be at ",(0,t.jsx)(n.code,{children:"https://pathling.example.com/admin/"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,t.jsxs)(n.p,{children:["When ",(0,t.jsx)(n.a,{href:"./authorization",children:"authorization"})," is enabled (",(0,t.jsx)(n.code,{children:"pathling.auth.enabled: true"}),"), the admin UI requires authentication via SMART on FHIR. Users must log\nin before accessing protected features."]}),"\n",(0,t.jsx)(n.h3,{id:"client-id-configuration",children:"Client ID configuration"}),"\n",(0,t.jsx)(n.p,{children:"The admin UI needs an OAuth client ID to initiate authentication flows. The\nclient ID is resolved using the following precedence:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"admin_ui_client_id"})," from the server's SMART configuration\n(",(0,t.jsx)(n.code,{children:"/.well-known/smart-configuration"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"VITE_CLIENT_ID"})," environment variable (set at build time)"]}),"\n",(0,t.jsxs)(n.li,{children:["Default value: ",(0,t.jsx)(n.code,{children:"pathling-admin-ui"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"To configure the client ID on the server:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"pathling:\n    adminUi:\n        clientId: your-client-id\n"})}),"\n",(0,t.jsx)(n.h3,{id:"token-authorities",children:"Token authorities"}),"\n",(0,t.jsxs)(n.p,{children:["When authorization is enabled, tokens issued by your authorization server must\ninclude an ",(0,t.jsx)(n.code,{children:"authorities"})," claim containing the appropriate Pathling authorities.\nFor full admin UI functionality, the token should include:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "authorities": ["pathling"]\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"pathling"})," authority grants access to all operations and resources. See\n",(0,t.jsx)(n.a,{href:"./authorization#authorities",children:"Authorization"})," for more granular authority\noptions."]}),"\n",(0,t.jsx)(n.p,{children:"Your authorization server must be configured to include this claim in issued\ntokens. The exact configuration depends on your provider:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Auth0"}),": Use a post-login Action to add custom claims"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Keycloak"}),': Configure a client scope with a "User Attribute" or "Hardcoded\nclaim" mapper']}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-an-oauth-client",children:"Setting up an OAuth client"}),"\n",(0,t.jsx)(n.p,{children:"To use the admin UI with authentication, you need to register an OAuth client\nwith your authorization server."}),"\n",(0,t.jsx)(n.h3,{id:"required-settings",children:"Required settings"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Setting"}),(0,t.jsx)(n.th,{children:"Value"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Client type"}),(0,t.jsx)(n.td,{children:"Public (no client secret)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PKCE"}),(0,t.jsx)(n.td,{children:"Required (S256)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Redirect URI"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"https://your-server/admin/callback"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Allowed scopes"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"openid profile user/*.*"})})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"auth0",children:"Auth0"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a new application in the Auth0 dashboard"}),"\n",(0,t.jsx)(n.li,{children:'Select "Single Page Application" as the application type'}),"\n",(0,t.jsxs)(n.li,{children:["Configure the following settings:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Allowed Callback URLs"}),": ",(0,t.jsx)(n.code,{children:"https://your-server/admin/callback"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Allowed Logout URLs"}),": ",(0,t.jsx)(n.code,{children:"https://your-server/admin/"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Allowed Web Origins"}),": ",(0,t.jsx)(n.code,{children:"https://your-server"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Copy the Client ID and configure it in Pathling:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"pathling:\n    auth:\n        enabled: true\n        issuer: https://your-tenant.au.auth0.com/\n        audience: https://your-server/fhir\n    adminUi:\n        clientId: your-auth0-client-id\n"})}),"\n",(0,t.jsx)(n.h3,{id:"keycloak",children:"Keycloak"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a new client in your Keycloak realm"}),"\n",(0,t.jsxs)(n.li,{children:["Configure the following settings:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Client Protocol"}),": openid-connect"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Access Type"}),": public"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Standard Flow Enabled"}),": ON"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Valid Redirect URIs"}),": ",(0,t.jsx)(n.code,{children:"https://your-server/admin/callback"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Web Origins"}),": ",(0,t.jsx)(n.code,{children:"https://your-server"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Copy the Client ID and configure it in Pathling:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"pathling:\n    auth:\n        enabled: true\n        issuer: https://keycloak.example.com/realms/your-realm\n        audience: https://your-server/fhir\n    adminUi:\n        clientId: your-keycloak-client-id\n"})}),"\n",(0,t.jsx)(n.h2,{id:"standalone-deployment",children:"Standalone deployment"}),"\n",(0,t.jsx)(n.p,{children:"The admin UI can be deployed separately from the Pathling Server, which is\nuseful for scenarios where you want to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Host the UI on a CDN or static file server"}),"\n",(0,t.jsx)(n.li,{children:"Use a different domain for the UI"}),"\n",(0,t.jsx)(n.li,{children:"Deploy multiple UI instances pointing to the same server"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"building-the-ui",children:"Building the UI"}),"\n",(0,t.jsx)(n.p,{children:"To build the UI for standalone deployment:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ui\nVITE_FHIR_BASE_URL=https://your-server/fhir VITE_CLIENT_ID=your-client-id bun run build\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This produces static files in the ",(0,t.jsx)(n.code,{children:"dist/"})," directory."]}),"\n",(0,t.jsx)(n.h3,{id:"environment-variables",children:"Environment variables"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Variable"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"Default"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"VITE_FHIR_BASE_URL"})}),(0,t.jsx)(n.td,{children:"The base URL of the FHIR server"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/fhir"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"VITE_CLIENT_ID"})}),(0,t.jsx)(n.td,{children:"The OAuth client ID"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"pathling-admin-ui"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"VITE_SCOPE"})}),(0,t.jsx)(n.td,{children:"The OAuth scopes to request"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"openid profile user/*.*"})})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"docker-deployment",children:"Docker deployment"}),"\n",(0,t.jsx)(n.p,{children:"Create a Dockerfile for nginx:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dockerfile",children:"FROM nginx:alpine\nCOPY dist/ /usr/share/nginx/html/admin/\nCOPY nginx.conf /etc/nginx/conf.d/default.conf\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Create an ",(0,t.jsx)(n.code,{children:"nginx.conf"})," for SPA routing:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    root /usr/share/nginx/html;\n    index index.html;\n\n    location /admin/ {\n        try_files $uri $uri/ /admin/index.html;\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Build and run:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker build -t pathling-admin-ui .\ndocker run -p 8080:80 pathling-admin-ui\n"})}),"\n",(0,t.jsx)(n.h3,{id:"static-hosting",children:"Static hosting"}),"\n",(0,t.jsx)(n.p,{children:"The built files can be deployed to any static hosting service:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"AWS S3"})," with CloudFront"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Cloudflare Pages"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Netlify"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Vercel"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Configure your hosting service to:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Serve files from the ",(0,t.jsx)(n.code,{children:"dist/"})," directory"]}),"\n",(0,t.jsxs)(n.li,{children:["Route all requests under ",(0,t.jsx)(n.code,{children:"/admin/"})," to ",(0,t.jsx)(n.code,{children:"/admin/index.html"})," (SPA fallback)"]}),"\n",(0,t.jsx)(n.li,{children:"Set appropriate CORS headers if hosting on a different domain"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"cors-configuration",children:"CORS configuration"}),"\n",(0,t.jsx)(n.p,{children:"When deploying the UI on a different domain, configure CORS on the Pathling\nServer:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'pathling:\n    cors:\n        allowedOriginPatterns:\n            - "https://your-ui-domain.com"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);