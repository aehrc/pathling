"use strict";(globalThis.webpackChunkpathling_site=globalThis.webpackChunkpathling_site||[]).push([[8915],{681:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>t,toc:()=>h});var t=r(8825),i=r(4848),s=r(8453);const a={slug:"new-pathling-server",title:"Introducing the new Pathling server",authors:["johngrimes"],tags:["release","server"]},o=void 0,l={authorsImageUrls:[void 0]},h=[{value:"Background",id:"background",level:2},{value:"What is Pathling server?",id:"what-is-pathling-server",level:2},{value:"SQL on FHIR",id:"sql-on-fhir",level:2},{value:"ViewDefinitions",id:"viewdefinitions",level:3},{value:"Running views interactively",id:"running-views-interactively",level:3},{value:"Exporting views at scale",id:"exporting-views-at-scale",level:3},{value:"Bulk data operations",id:"bulk-data-operations",level:2},{value:"Import",id:"import",level:3},{value:"Synchronisation with remote servers",id:"synchronisation-with-remote-servers",level:3},{value:"Export",id:"export",level:3},{value:"CRUD operations and search",id:"crud-operations-and-search",level:2},{value:"FHIRPath search",id:"fhirpath-search",level:3},{value:"Web interface",id:"web-interface",level:2},{value:"Deployment",id:"deployment",level:2},{value:"Docker",id:"docker",level:3},{value:"Kubernetes with Helm",id:"kubernetes-with-helm",level:3},{value:"Caching",id:"caching",level:3},{value:"Getting started",id:"getting-started",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"We're excited to announce the release of a new Pathling server. This is a\nground-up redesign that brings SQL on FHIR support, a web-based administration\ninterface, Kubernetes deployment via Helm, and comprehensive bulk data\noperations."}),"\n",(0,i.jsx)(n.h2,{id:"background",children:"Background"}),"\n",(0,i.jsxs)(n.p,{children:["Earlier versions of Pathling included a server component with custom operations\nlike ",(0,i.jsx)(n.code,{children:"$aggregate"})," and ",(0,i.jsx)(n.code,{children:"$extract"})," for analytics queries. While these were\npowerful, they were Pathling-specific and didn't interoperate with other\nsystems."]}),"\n",(0,i.jsxs)(n.p,{children:["With the ",(0,i.jsx)(n.a,{href:"https://github.com/aehrc/pathling/releases/tag/v8.0.0",children:"v8.0.0 release"}),",\nwe removed the server to focus on the core libraries. Now the server is back,\nrebuilt with a standards-based approach and versioned independently from the\nlibraries (starting at 1.0.0)."]}),"\n",(0,i.jsxs)(n.p,{children:["The new server exclusively depends on the ",(0,i.jsx)(n.code,{children:"library-runtime"})," module, which\nprovides a much looser coupling to the core Pathling libraries. This makes the\nserver lighter and more maintainable."]}),"\n",(0,i.jsx)(n.h2,{id:"what-is-pathling-server",children:"What is Pathling server?"}),"\n",(0,i.jsxs)(n.p,{children:["Pathling server is a ",(0,i.jsx)(n.a,{href:"https://hl7.org/fhir/R4/",children:"FHIR R4"})," analytics server that\naccepts data from multiple sources, stores it in an optimised data warehouse,\nand exposes powerful query and export capabilities. It's built on\n",(0,i.jsx)(n.a,{href:"https://spark.apache.org/",children:"Apache Spark"})," for distributed processing and\nsupports both single-node and cluster deployments."]}),"\n",(0,i.jsx)(n.h2,{id:"sql-on-fhir",children:"SQL on FHIR"}),"\n",(0,i.jsxs)(n.p,{children:["The headline feature is support for the\n",(0,i.jsx)(n.a,{href:"https://sql-on-fhir.org/",children:"SQL on FHIR"})," specification.\nThis replaces the previous ",(0,i.jsx)(n.code,{children:"$aggregate"})," and ",(0,i.jsx)(n.code,{children:"$extract"})," operations with a\nstandards-based approach that works across implementations\u2014ViewDefinitions\ncreated for Pathling will work on any SQL on FHIR compliant system."]}),"\n",(0,i.jsx)(n.p,{children:"ViewDefinitions are portable, declarative definitions that specify how to\nflatten hierarchical FHIR resources into rows and columns."}),"\n",(0,i.jsx)(n.h3,{id:"viewdefinitions",children:"ViewDefinitions"}),"\n",(0,i.jsx)(n.p,{children:"A ViewDefinition specifies which resource type to query and how to extract\ncolumns using FHIRPath expressions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "resourceType": "ViewDefinition",\n    "name": "patient_demographics",\n    "resource": "Patient",\n    "status": "active",\n    "select": [\n        {\n            "column": [\n                { "name": "id", "path": "id" },\n                { "name": "family", "path": "name.first().family" },\n                { "name": "given", "path": "name.first().given.first()" },\n                { "name": "gender", "path": "gender" },\n                { "name": "birth_date", "path": "birthDate" }\n            ]\n        }\n    ]\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"running-views-interactively",children:"Running views interactively"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$viewdefinition-run"})," operation executes a ViewDefinition and returns\nresults synchronously. This is ideal for interactive exploration and testing:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://localhost:8080/fhir/$viewdefinition-run\' \\\n  -H \'Content-Type: application/fhir+json\' \\\n  -H \'Accept: application/x-ndjson\' \\\n  -d \'{\n    "resourceType": "Parameters",\n    "parameter": [\n      {\n        "name": "viewResource",\n        "resource": {\n          "resourceType": "ViewDefinition",\n          "name": "patient_demographics",\n          "resource": "Patient",\n          "status": "active",\n          "select": [\n            {\n              "column": [\n                { "name": "id", "path": "id" },\n                { "name": "family", "path": "name.first().family" }\n              ]\n            }\n          ]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,i.jsx)(n.p,{children:"The response is newline-delimited JSON:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{"id":"patient-1","family":"Smith"}\n{"id":"patient-2","family":"Jones"}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You can also request CSV output by setting ",(0,i.jsx)(n.code,{children:"Accept: text/csv"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"exporting-views-at-scale",children:"Exporting views at scale"}),"\n",(0,i.jsxs)(n.p,{children:["For larger datasets, use ",(0,i.jsx)(n.code,{children:"$viewdefinition-export"})," to run views asynchronously\nand export results to files. This operation supports multiple output formats:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"NDJSON"})," \u2013 newline-delimited JSON"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CSV"})," \u2013 comma-separated values"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Parquet"})," \u2013 columnar format for efficient analytics"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://localhost:8080/fhir/$viewdefinition-export\' \\\n  -H \'Content-Type: application/fhir+json\' \\\n  -H \'Accept: application/fhir+json\' \\\n  -H \'Prefer: respond-async\' \\\n  -d \'{\n    "resourceType": "Parameters",\n    "parameter": [\n      {\n        "name": "viewResource",\n        "resource": { "...ViewDefinition..." }\n      },\n      {\n        "name": "_outputFormat",\n        "valueString": "application/vnd.apache.parquet"\n      }\n    ]\n  }\'\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The server returns a ",(0,i.jsx)(n.code,{children:"202 Accepted"})," response with a ",(0,i.jsx)(n.code,{children:"Content-Location"})," header\npointing to a status endpoint. Poll this endpoint until the job completes, then\ndownload the result files."]}),"\n",(0,i.jsx)(n.h2,{id:"bulk-data-operations",children:"Bulk data operations"}),"\n",(0,i.jsx)(n.h3,{id:"import",children:"Import"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$import"})," operation loads FHIR data from external sources into the server.\nSupported formats include:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Format"}),(0,i.jsx)(n.th,{children:"MIME type"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"NDJSON"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"application/fhir+ndjson"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Parquet"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"application/vnd.apache.parquet"})})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Data can be loaded from Amazon S3 (",(0,i.jsx)(n.code,{children:"s3a://"}),"), HDFS, or the local filesystem."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://localhost:8080/fhir/$import\' \\\n  -H \'Content-Type: application/json\' \\\n  -H \'Prefer: respond-async\' \\\n  -d \'{\n    "inputFormat": "application/fhir+ndjson",\n    "input": [\n      { "type": "Patient", "url": "s3a://my-bucket/Patient.ndjson" },\n      { "type": "Observation", "url": "s3a://my-bucket/Observation.ndjson" }\n    ],\n    "mode": "merge"\n  }\'\n'})}),"\n",(0,i.jsx)(n.p,{children:"Import modes control how incoming data interacts with existing resources:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"overwrite"})," \u2013 replace all existing resources of each type"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"merge"})," \u2013 update existing resources by ID, add new ones"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"append"})," \u2013 add resources without modifying existing data"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"synchronisation-with-remote-servers",children:"Synchronisation with remote servers"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$import-pnp"})," (ping and pull) operation fetches data directly from a FHIR\nserver that supports bulk export. Pathling initiates the export, polls for\ncompletion, downloads the files, and imports them\u2014all in a single operation."]}),"\n",(0,i.jsx)(n.p,{children:"This enables scheduled synchronisation with source systems:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://localhost:8080/fhir/$import-pnp\' \\\n  -H \'Content-Type: application/fhir+json\' \\\n  -H \'Prefer: respond-async\' \\\n  -d \'{\n    "resourceType": "Parameters",\n    "parameter": [\n      { "name": "exportUrl", "valueUrl": "https://source.example.com/fhir/$export" },\n      { "name": "saveMode", "valueCode": "merge" }\n    ]\n  }\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"export",children:"Export"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$export"})," operation extracts data from the server using the\n",(0,i.jsx)(n.a,{href:"https://hl7.org/fhir/uv/bulkdata/",children:"FHIR Bulk Data Access"})," specification.\nExports can be scoped to the entire system, a specific patient, or members of a\nGroup:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# System-level export\ncurl -X GET 'http://localhost:8080/fhir/$export' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Prefer: respond-async'\n\n# Patient-level export\ncurl -X GET 'http://localhost:8080/fhir/Patient/123/$export' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Prefer: respond-async'\n\n# Group-level export\ncurl -X GET 'http://localhost:8080/fhir/Group/cohort/$export' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Prefer: respond-async'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"crud-operations-and-search",children:"CRUD operations and search"}),"\n",(0,i.jsx)(n.p,{children:"The server supports full CRUD operations on FHIR resources:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Create\ncurl -X POST \'http://localhost:8080/fhir/Patient\' \\\n  -H \'Content-Type: application/fhir+json\' \\\n  -d \'{ "resourceType": "Patient", "name": [{ "family": "Smith" }] }\'\n\n# Read\ncurl -X GET \'http://localhost:8080/fhir/Patient/123\'\n\n# Update\ncurl -X PUT \'http://localhost:8080/fhir/Patient/123\' \\\n  -H \'Content-Type: application/fhir+json\' \\\n  -d \'{ "resourceType": "Patient", "id": "123", "name": [{ "family": "Jones" }] }\'\n\n# Delete\ncurl -X DELETE \'http://localhost:8080/fhir/Patient/123\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"fhirpath-search",children:"FHIRPath search"}),"\n",(0,i.jsx)(n.p,{children:"Search for resources using FHIRPath expressions instead of standard FHIR search\nparameters. This provides more expressive filtering capabilities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Find male patients\ncurl 'http://localhost:8080/fhir/Patient?_query=fhirPath&filter=gender%3D%27male%27'\n\n# Find patients born after 1980\ncurl 'http://localhost:8080/fhir/Patient?_query=fhirPath&filter=birthDate%20%3E%20%401980-01-01'\n\n# Find observations with specific code and value above threshold\ncurl 'http://localhost:8080/fhir/Observation?_query=fhirPath&filter=code.coding.code%3D%278867-4%27%20and%20valueQuantity.value%20%3E%20100'\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Multiple ",(0,i.jsx)(n.code,{children:"filter"})," parameters are combined with AND logic. Comma-separated\nexpressions within a single parameter use OR logic."]}),"\n",(0,i.jsx)(n.h2,{id:"web-interface",children:"Web interface"}),"\n",(0,i.jsx)(n.p,{children:"A new React-based web interface provides administrative access to the server:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dashboard"})," \u2013 view server information, supported resources, and available\noperations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Resources"})," \u2013 browse and search FHIR resources using FHIRPath expressions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SQL on FHIR"})," \u2013 execute ViewDefinitions interactively and export results"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Import/Export"})," \u2013 manage bulk data operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Authentication"})," \u2013 SMART on FHIR integration for protected servers"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"The SQL on FHIR interface showing a ViewDefinition and tabular results",src:r(9463).A+"",width:"2432",height:"1156"})}),"\n",(0,i.jsx)(n.p,{children:"The UI is served directly by the server and requires no additional deployment."}),"\n",(0,i.jsx)(n.h2,{id:"deployment",children:"Deployment"}),"\n",(0,i.jsx)(n.h3,{id:"docker",children:"Docker"}),"\n",(0,i.jsx)(n.p,{children:"Start a server with Docker:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -p 8080:8080 ghcr.io/aehrc/pathling:1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The FHIR API is available at ",(0,i.jsx)(n.code,{children:"http://localhost:8080/fhir"})," and the web UI at\n",(0,i.jsx)(n.code,{children:"http://localhost:8080"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"kubernetes-with-helm",children:"Kubernetes with Helm"}),"\n",(0,i.jsx)(n.p,{children:"For production deployments, use the Helm chart:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm repo add pathling https://pathling.csiro.au/helm\nhelm repo update\nhelm install pathling pathling/pathling\n"})}),"\n",(0,i.jsx)(n.p,{children:"The chart supports both single-node and cluster deployments. In cluster mode,\nthe driver pod spawns Spark executor pods on demand via the Kubernetes API:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"pathling:\n    image: ghcr.io/aehrc/pathling:1\n    resources:\n        requests:\n            cpu: 2\n            memory: 4G\n        limits:\n            memory: 4G\n    volumes:\n        - name: warehouse\n          persistentVolumeClaim:\n              claimName: pathling-warehouse\n    volumeMounts:\n        - name: warehouse\n          mountPath: /usr/share/warehouse\n    config:\n        pathling.implementationDescription: My Pathling Server\n"})}),"\n",(0,i.jsx)(n.h3,{id:"caching",children:"Caching"}),"\n",(0,i.jsxs)(n.p,{children:["A Varnish-based caching layer is available for deployments with high read\ntraffic. The cache respects ",(0,i.jsx)(n.code,{children:"Cache-Control"})," headers and can significantly reduce\nload on the server for repeated queries."]}),"\n",(0,i.jsx)(n.h2,{id:"getting-started",children:"Getting started"}),"\n",(0,i.jsx)(n.p,{children:"Pull the Docker image and start exploring:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -p 8080:8080 ghcr.io/aehrc/pathling:1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Then open ",(0,i.jsx)(n.code,{children:"http://localhost:8080"})," in your browser to access the web UI, or use\ncurl to interact with the FHIR API at ",(0,i.jsx)(n.code,{children:"http://localhost:8080/fhir"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For detailed documentation on all operations and configuration options, see the\n",(0,i.jsx)(n.a,{href:"/docs/server",children:"server documentation"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var t=r(6540);const i={},s=t.createContext(i);function a(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}},8825:e=>{e.exports=JSON.parse('{"permalink":"/blog/new-pathling-server","editUrl":"https://github.com/aehrc/pathling/tree/main/site/blog/2026-01-05-new-pathling-server.md","source":"@site/blog/2026-01-05-new-pathling-server.md","title":"Introducing the new Pathling server","description":"We\'re excited to announce the release of a new Pathling server. This is a","date":"2026-01-05T00:00:00.000Z","tags":[{"inline":true,"label":"release","permalink":"/blog/tags/release"},{"inline":true,"label":"server","permalink":"/blog/tags/server"}],"readingTime":6.48,"hasTruncateMarker":true,"authors":[{"name":"John Grimes","url":"https://github.com/johngrimes","key":"johngrimes","page":null}],"frontMatter":{"slug":"new-pathling-server","title":"Introducing the new Pathling server","authors":["johngrimes"],"tags":["release","server"]},"unlisted":false,"nextItem":{"title":"Welcome to the Pathling blog","permalink":"/blog/welcome"}}')},9463:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/sql-on-fhir-ui-23f137ff2944eaa9fab4d35e4ac038ed.png"}}]);